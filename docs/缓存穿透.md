## 概述

**缓存穿透**是指请求的数据既不在缓存中，也不在数据库中。这种情况会导致缓存直接“穿透”并访问数据库，极大增加数据库的压力。

### 实现

防御缓存穿透常用手段：布隆过滤器→空值缓存→熔断降级

使用布隆过滤器拦截非法key

动态空值缓存应对穿透漏网之鱼

数据库保护机制触发熔断

#### 布隆过滤器

 **布隆过滤器（Bloom Filter）**是一种非常高效的空间节省的数据结构，通常用于检测某个元素是否存在于一个集合中。它的特点是能用极少的内存存储大量数据，并且能够在常数时间内进行查询，但它也有一个缺点：可能会误判（即认为某个元素存在，但实际上并不存在），但绝对不会漏判（即认为某个元素不存在，但实际上存在）。

布隆过滤器可以用于防止缓存穿透，提前在布隆过滤器中判断某个数据是否存在。如果不存在，则直接返回空值，避免查询数据库。

**构建布隆过滤器**：

- 在系统中维护一个布隆过滤器，用于保存所有可能存在于数据库中的有效数据的标识符（如ID、用户名、商品编号等）。
- 在系统初始化时，将所有有效的数据标识符批量插入到布隆过滤器中。

**请求处理流程**：

- 当客户端发起请求时，首先检查布隆过滤器中是否存在该数据。
- 如果布隆过滤器判定数据**不存在**，则直接返回空值或者错误信息，避免无效查询。
- 如果布隆过滤器判定数据，可能存在则接下来查询缓存。
  - 如果缓存中存在数据，直接返回缓存数据。
  - 如果缓存中没有数据，再查询数据库并将查询结果缓存起来。

预存所有合法key的指纹，拦截明显非法请求

#### 缓存空值

动态缓存空值数据，并设置ttl

#### 数据库保护机制

根据qps，启用熔断机制

### **结语**

真正的系统高可用，靠的不是某个银弹，而是层层防御的艺术。